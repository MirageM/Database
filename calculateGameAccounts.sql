SELECT a.username, a.email, count(i.id) AS items, SUM(i.weight) AS total_weight
FROM accounts a
JOIN accounts_items ai ON a.id = ai.account_id
JOIN items i ON ai.item_id = i.id
GROUP BY a.id, a.username, a.email
HAVING SUM(i.weight) > 20
ORDER BY total_weight DESC, username ASC;

SELECT a.username, a.email, count(i.id) AS items, SUM(i.weight) AS total_weight
FROM accounts a
JOIN accounts_items ai ON a.id = ai.account_id
JOIN items i ON ai.item_id = i.id
GROUP BY a.id, a.username, a.email
HAVING SUM(i.weight) > 20
ORDER BY total_weight DESC, username ASC;

SELECT a.username, a.email, count(i.id) AS items, SUM(i.weight) AS total_weight
FROM accounts a
JOIN accounts_items ai ON a.id = ai.account_id
JOIN items i ON ai.item_id = i.id 
GROUP BY a.id, a.username, a.email
HAVING SUM(i.weight) > 20
ORDER BY total_weight DESC, username ASC;

SELECT a.username, a.email, count(i.id) AS items, SUM(i.weight) AS total_weight
FROM accounts a
JOIN accounts_items ai ON a.id = ai.account_id
JOIN items i ON ai.item_id = i.id
GROUP BY a.id, a.username, a.email
HAVING SUM(i.weight) > 20
ORDER BY total_weight DESC, username ASC;

SELECT a.username, a.email, count(i.id) AS items, SUM(i.weight) AS total_weight
FROM accounts a
JOIN accounts_items ai ON a.id = ai.account_id
JOIN items i ON ai.item_id = i.id
GROUP BY a.id, a.username, a.email
HAVING SUM(i.weight) > 20
ORDER BY total_weight DESC, username ASC;

SELECT a.username, a.email, count(i.id) AS items, SUM(i.weight) AS total_weight
FROM accounts a
JOIN accounts_items ai ON a.id = ai.account_id
JOIN items i ON ai.item_id = i.id
GROUP BY a.id, a.username, a.email
HAVING SUM(i.weight) > 20
ORDER BY total_weight DESC, username ASC;


SELECT a.username, a.email, count(i.id) AS items, SUM(i.weight) AS total_weight
FROM accounts a
JOIN accounts_items ai ON a.id = ai.account_id
JOIN items i ON ai.item_id = i.id
GROUP BY a.id, a.username, a.email
HAVING SUM(i.weight) > 20
ORDER BY total_weight DESC, username ASC;

SELECT a.username, a.email, count(i.id) AS items, SUM(i.weight) AS total_weight
FROM accounts a
JOIN accounts_items ai ON a.id = ai.account_id
JOIN items i ON ai.item_id = i.id
GROUP BY a.id, a.username, a.email
HAVING SUM(i.weight) > 20
ORDER BY total_weight DESC, username ASC;

SELECT a.username, a.email, count(i.id) AS items, SUM(i.weight) AS total_weight
FROM accounts a
JOIN accounts_items ai ON a.id = ai.account_id
JOIN items i ON ai.item_id = i.id
GROUP BY a.id, a.username, a.email
HAVING SUM(i.weight) > 20
ORDER BY total_weight DESC, username ASC;

SELECT a.username, a.email, count(i.id) AS items, SUM(i.weight) AS total_weight
FROM accounts a
JOIN accounts_items ai ON a.id = ai.account_id
JOIN items i ON ai.item_id = i.id
GROUP BY a.id, a.username, a.email
HAVING SUM(i.weight) > 20
ORDER BY total_weight DESC, username ASC;

SELECT a.username, a.email, count(i.id) AS items, SUM(i.weight) AS total_weight
FROM accounts a
JOIN accounts_items ai ON a.id = ai.account_id
JOIN items i ON ai.item_id = i.id
GROUP BY a.id, a.username, a.email
HAVING SUM(i.weight) > 20
ORDER BY total_weight DESC, username ASC;

SELECT a.username, a.email, count(i.id) AS items, SUM(i.weight) AS total_weight
FROM accounts a
JOIN accounts_items ai ON a.id = ai.account_id
JOIN items i ON ai.item_id = i.id
GROUP BY a.id, a.username, a.email
HAVING SUM(i.weight) > 20
ORDER BY total_weight DESC, username ASC;

SELECT a.username, a.email, count(i.id) AS items, SUM(i.weight) AS total_weight
FROM accounts a
JOIN accounts_items ai ON a.id = ai.account_id
JOIN items i ON ai.item_id = i.id
GROUP BY a.id, a.username, a.email 
HAVING SUM(i.weight) > 20
ORDER BY total_weight DESC, username ASC;

SELECT a.username, a.email, count(i.id) AS items, SUM(i.weight) AS total_weight
FROM accounts a
JOIN accounts_items ai ON a.id = ai.account_id
JOIN items i ON ai.item_id = i.id
GROUP BY a.id, a.username, a.email
HAVING SUM(i.weight) > 20
ORDER BY total_weight DESC, username ASC;

SELECT a.username, a.email, count(i.id) AS items, SUM(i.weight) AS total_weight
FROM accounts a
JOIN accounts_items ai ON a.id = ai.account_id
JOIN items i ON ai.item_id = i.id
GROUP BY a.id, a.username, a.email
HAVING SUM(i.weight) > 20
ORDER BY total_weight DESC, username ASC;

SELECT a.username, a.email, count(i.id) AS items, SUM(i.weight) AS total_weight
FROM accounts a
JOIN accounts_items ai ON a.id = ai.account_id
JOIN items i ON ai.item_id = i.id
GROUP BY a.id, a.username, a.email
HAVING SUM(i.weight) > 20
ORDER BY total_weight DESC, username ASC;

SELECT a.username, a.email, count(i.id) AS items, SUM(i.weight) AS total_weight
FROM accounts a
JOIN accounts_items ai ON a.id = ai.account_id
JOIN items i ON ai.item_id = i.id
GROUP BY a.id, a.username, a.email
HAVING SUM(i.weight) > 20
ORDER BY total_weight DESC, username ASC;

SELECT a.username, a.email, count(i.id) AS items, SUM(i.weight) AS total_weight
FROM accounts a
JOIN accounts_items ai ON a.id = ai.account_id
JOIN items i ON ai.item_id = i.id
GROUP BY a.id, a.username, a.email
HAVING SUM(i.weight) > 20
ORDER BY total_weight DESC, username ASC;

SELECT a.username, a.email, count(i.id) AS items, SUM(i.weight) AS total_weight
FROM accounts a
JOIN accounts_items ai ON a.id = ai.account_id
JOIN items i ON ai.item_id = i.id
GROUP BY a.id, a.username, a.email
HAVING SUM(i.weight) > 20
ORDER BY total_weight DESC, username ASC;

SELECT a.username, a.email, count(i.id) AS items, SUM(i.weight) AS total_weight
FROM accounts a
JOIN accounts_items ai ON a.id = ai.account_id
JOIN items i ON ai.item_id = i.id
GROUP BY a.id, a.username, a.email
HAVING SUM(i.weight) > 20
ORDER BY total_weight DESC, username ASC;

SELECT a.username, a.email, count(i.id) AS items, SUM(i.weight) AS total_weight
FROM accounts a
JOIN accounts_items ai ON a.id = ai.account_id
JOIN items i ON ai.item_id = i.id
GROUP BY a.id, a.username, a.email
HAVING SUM(i.weight) > 20
COUNT BY total_weight DESC, username ASC;

SELECT a.username, a.email, count(i.id) AS items, SUM(i.weight) AS total_weight
SELECT a.username, a.email, count(i.id) AS items, SUM(i.weight) AS total_weight
SELECT a.username, a.email, count(i.id) AS items, SUM(i.weight) AS total_weight
SELECT a.username, a.email, count(i.id) AS items, SUM(i.weight) AS total_weight
SELECT a.username, a.email, count(i.id) AS items, SUM(i.weight) AS total_weight
SELECT a.username, a.email, count(i.id) AS items, SUM(i.weight) AS total_weight
SELECT a.username, a.email, count(i.id) AS items, SUM(i.weight) AS total_weight
SELECT a.username, a.email, count(i.id) AS items, SUM(i.weight) AS total_weight
SELECT a.username, a.email, count(i.id) AS items, SUM(i.weight) AS total_weight